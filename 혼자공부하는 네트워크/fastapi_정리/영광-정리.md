# 1.파이썬이 느린 이유

### 1. 인터프리터 언어

인터프리터 언어와 컴파일 언어가 있다. 

인터프리터 언어는 한줄씩 입력과 실행이 되는 과정이 있기 때문에 속도가 느리다. 실행할때마다 해석해야 하기 때문이다. 하지만 디버깅이 쉽고, 인터프리터가 설치되어 있으면 다양한 플랫폼에서 동일한 소스 코드를 실행할 수 있다. 

컴파일 언어는 소스 코드를 한번에 기계어 코드로 변환한 후 실행합니다. 컴파일된 결과물은 실행 파일 형태로 저장된다. 컴파일 과정에서 최적화가 이루어지기 때문에 속도가 빠르다. 하지만 실행 파일을 실행하는 도중 발생하는 런타임 에러는 디버깅이 어렵고, 다른 플랫폼에서 실행하려면 다시 컴파일해야 할 수 있습니다.

### 2. 동적 타이핑

파이썬은 동적 타이핑(dynamic typing) 언어입니다. 변수의 타입을 실행 시점에 결정하므로, 이걸 저장할때 힙과 스택중에 힙이 선택된다. 파이썬의 지역변수, 호줄정보는 스택에 저장되지만 타입의 값을 정할 때는 실행할때 비로소 정해지게 된다. 이럴 경우 메모리 크기가 제한적이고 속도가 빠른 stack보다는 heap에 저장해서 작동시켜야한다. 이부분에서 속도의 누수가 발생한다.

### 3. 전역 인터프리터 잠금(GIL)

프로세스와 스레드의 개념을 알고 이해하면쉽다. 

흔히 cpu에 멀티 코어라고 부르는 말이 멀티 프로세스이다. 8코어16스레드면 프로세스는 8개 그안에 각각2개의 스레드가 있어서 총 16스레드가 되는것이다. GIL의 개념은 여기서 출발한다. 1개의 프로세스에 여러개의 스레드가 있을때, 스레드는 각각 동시에 행동을 한다. 이 과정에서 2개의 스레드가 data에 접근할 경우 충돌이 생긴다. 이를 미연에 방지하기 위해 하나의 스레드만을 사용한다. 이 과정에서 속도의 낭비가 생기면서 파이썬의 속도가 느려지는 결과가 나온다. 

### 4. 메모리 관리

파이썬은 가비지 컬렉션(garbage collection)을 통해 메모리를 관리합니다. 

힙을 사용하는 파이썬은 메모리 누수를 방지하기 위해 참조 카운팅을 사용한다. 파이썬의 객체는 참조 카운팅을 가지고 있고 다른곳에서 이 객체를 참조할 경우 1씩 증가하며 아무도 참조하지 않을경우 0으로 계산되어 힙에서 제거하여 메모리 누수를 막는다. 

하지만 객체가 순환참조하여 둘간의 카운팅이 1에서 내려가지 않을경우 메모리 누수가 발생한다. 이것을 방지하는 것이 가비지 컬렉션인데 gc는 순환 참조를 탐지하고 해제하는 기능을 제공한다. 하지만 이 과정에서 파이썬의 성능저하가 발생할 수 있다. 

### 5. 인터프리터 오버헤드

파이썬은 많은 런타임 오버헤드를 가지고 있습니다. 함수 호출, 메서드 호출, 객체 생성 및 소멸 등이 상당히 비용이 많이 드는 작업입니다.

### 6. 고급 기능

파이썬은 많은 고급 기능을 제공하며, 이들 기능은 추가적인 오버헤드를 초래할 수 있습니다. 예를 들어, 예외 처리, 리플렉션(reflection), 데코레이터 등이 있습니다.

- 원시타입과 참조타입

앞에서 설명했듯 코드가 작동하려면 레지스터와 같은 메모리에 값이 저장되고, 다시 불러오는 과정들이 필요하다. 

이 과정에서 2가지 타입 원시타입, 참조타입이 있는데 

파이썬의 경우 원시타입과 비슷한 개념만 있을 뿐 참조타입을 사용한다. 값을 변경할 수 없는 불변한 변수나 값을 직접 입력하는 경우를 제외하고는 전부 참조타입을 이용한다. 

이 참조 타입은 메모리에 저장할때 값을 저장하고 그 주소를 가져온다. 다시 그 값을 찾으러가려면 주소를 가지고 메모리에가서 맞는 데이터를 가져와야하기 때문에 원시타입보다 속도가 느리다. 

# fastapi란?

## Fast API 란 ?

- 파이썬 3.6 이상에서 작동하는 표준 파이썬 타입 힌트를 바탕으로한 빠른 API 서버 웹 프레임 워크
- Flask와 비슷한 구조를 가졌으며, 기본적으로 비동기식으로 작성. I/O(입출력) 병목 현상이 자주 일어나는 웹 서버에서 빠른 성능을 보여준다.
- 비동기식 프로그래밍이란?
    
    비동기식 프로그래밍에서는 I/O 작업이 시작된 후, 작업이 완료되기를 기다리지 않고 다른 작업을 계속할 수 있습니다. I/O 작업이 완료되면, 그 시점에 맞춰 결과를 처리하는 방식입니다.
    
    이를 통해 CPU를 더 효율적으로 활용할 수 있고, 많은 수의 동시 요청을 효과적으로 처리할 수 있습니다.
    
    ### 
    

## 특징

1. 속도 : Starlette과 Pydantic 덕분에 Node.js 및 Go같은 고성능 웹서버 와 대등할 정도로 매우 높은 성능을 제공합니다. FastAPI는 Starlette이라는 비동기 프레임워크를 사용하여 고성능을 발휘. 사용 가능한 가장 빠른 파이썬 프레임워크 중 하나
- Starlette
    
    **Starlette**는 Python의 비동기 웹 프레임워크
    
    - **비동기 프로그래밍 지원**: Starlette는 비동기 프로그래밍을 지원.  비동기 프로그래밍은 I/O 바운드 작업을 효율적으로 처리하여, 많은 요청을 동시에 처리할 수 있게 I/O 작업이 많은 요청들을 빠르게 처리
    - **고성능**: Starlette는 비동기 기능을 제공하여 높은 성능을 발휘. Node.js와 Go의 비동기 및 동시성 처리 성능과 대등.
    - **경량 프레임워크**: Starlette는 매우 가볍고, 필요에 따라 확장할 수 있어 성능을 최대화.
1. 빠른 코드 작성: 약 200%에서 300%까지 기능 개발 속도 증가. Pydantic를 이용한 입출력을 정의하고 입출력 값의 검증을 빠르고 안전하게 작성 가능.
- Pydantic
    
    데이터 유효성 검사와 설정 관리를 위한 Python 라이브러리.
    
    - **데이터 유효성 검사**: Pydantic은 입력 데이터의 유효성을 빠르고 안전하게 검사. 이는 데이터가 올바르게 처리되도록 보장하며, 오류를 줄인다.
    - **타입 힌트 사용**: Pydantic은 Python의 타입 힌트를 사용하여 데이터 모델을 정의. 코드의 가독성을 높이고, 개발자가 데이터를 다루기 쉽게 만듦.
    - **고속 처리**: Pydantic은 Cython으로 최적화되어 있어, 데이터 처리 속도가 매우 빠름.
1. 적은 버그: 사람(개발자)에 의한 에러 약 40% 감소. 
2. 직관적이고 쉽고 짧은 코드: 훌륭한 편집기 지원. 모든 곳에서 자동완성. 적은 디버깅 시간. 쉽게 사용하고 배우도록 설계. 적은 문서 읽기 시간. 코드 중복 최소화. 각 매개변수 선언의 여러 기능. 적은 버그.
3. 견고함: 자동 대화형 문서와 함께 준비된 프로덕션용 코드가 있음. Swagger UI 를 이용해 자동으로 생성되는 API문서를 손쉽게 테스트 할 수 있다.
4. 표준 기반 : API에 대해 완전히 호환되는 개방형 표준(OpenAPI 및 JSON 스키마)을 기반하여 다른 도구 및 서비스와의 호환성 보장
5. 자동 문서화 : 코드 변화에 따라 발생하는 요청/응답 스키마를 자동으로 문서화 해 제공하는 파이프라인 제공 → 업무 효율 증진
6. 마이크로서비스 지향 : Django같이 큰 프레임워크로 개발하는 것보다, 서버를 작은 단위로 기능별로 분할하여 만드는 방식. 마이크로서비스 아키텍처를 쉽게 구현
7. 범용성 : 한번 만든 API를 여러 클라이언트에서 변경 없이 사용가능. 다양한 클라이언트와의 호환성을 유지하면서 API를 효율적으로 재사용

*비동기식 프로그래밍 

gil이 걸리는 fastapi의 경우 멀티 프로세스를 이용해서 gil의 한계를 극복한다. 

### Gunicorn과 Uvicorn 예시

Gunicorn은 멀티 프로세스를 지원하는 WSGI 서버

Uvicorn은 ASGI 서버로, 비동기 프로그래밍을 지원 

Gunicorn과 Uvicorn을 함께 사용하면 멀티 프로세스 환경에서 비동기 FastAPI 애플리케이션을 실행할 수 있다.

# 3.fast api와 장고

파이썬 기반 웹 프레임워크

## 장고

웹 애플리케이션 개발에 필요한 모든 것을 제공

개발 초기 단계에서 많은 기능을 빠르게 구현

동기 프로그래밍

- **장점**: 완벽한 웹 애플리케이션을 빠르게 구축할 수 있는 모든 도구를 제공.
- **단점**: 기본적으로 동기 프로그래밍을 사용하므로 고도의 동시성이 필요한 작업에서는 성능이 떨어질 수 있음.

## fast api

고성능 API를 빠르고 쉽게 만들기 위한 프레임워크

비동기 프로그래밍

고성능 API 개발을 목적으로 하는 프레임워크

고성능 API는 대량의 요청을 효율적으로 처리할 수 있는 API를 의미합니다. 이는 다음과 같은 상황에서 중요합니다:

1. **실시간 데이터 처리**: 주식 거래 시스템, 채팅 애플리케이션, 게임 서버 등
2. **대규모 트래픽 처리**: 소셜 네트워크, 인기 있는 웹 서비스 등
3. **데이터 집약적 애플리케이션**: 데이터 분석 플랫폼, 머신 러닝 모델 제공 서비스 등

### 둘의 차이점은??

둘의 개념이 상반대는게 아니라 애초에 상호보완적인 영역임

장고가 전통적인 방식의 웹애플리케이션을 제작하고, 기본적으로 사용할 수 있는 많은 기능을 제공해준다면, 

fastapi는 고성능 api를 위해 개발되어서 비동기식으로 진행되기 때문에 대용량 트래픽, 주식, 게임개발 등의 부분에서 능력을 발휘함

장고의 부족한 부분을 fastapi로 보완할 수 있기 때문에 상황에 따라서 적절한 프레임워크를 선택해서 사용하는것이 좋음

## 4.**Flask vs. FastAPI 비교:**

**성능**: FastAPI는 비동기 처리를 지원하므로 높은 성능을 제공합니다. 특히 I/O 바운드 작업에서 우수한 성능을 보여줍니다. Flask도 빠르지만 FastAPI보다는 상대적으로 성능이 떨어질 수 있습니다.

**자동 문서화:** FastAPI는 타입 힌팅을 활용하여 API 요청과 응답 모델을 자동으로 문서화합니다. 이로 인해 개발자들은 별도의 문서 작업 없이도 사용 가능한 API를 쉽게 확인할 수 있습니다. 반면 Flask는 이러한 기능을 제공하지 않으며, 별도의 라이브러리를 사용해야 합니다.

**개발 속도:** FastAPI는 자동 완성 및 타입 힌팅을 지원하여 개발자들이 더 빠르게 개발할 수 있도록 도와줍니다. 또한, 자동 API 문서 생성 기능 덕분에 문서 작성에 드는 시간을 줄일 수 있습니다.

**커뮤니티:** Flask는 오랜 기간 동안 사용되어진 만큼 큰 커뮤니티를 가지고 있으며, 다양한 확장 라이브러리를 사용할 수 있습니다. 반면 FastAPI는 비교적 최근에 개발되었으나 빠르게 성장하고 있는 프레임워크입니다.

**결론:**

Flask와 FastAPI는 각각의 장단점을 가진 파이썬 웹 프레임워크로서, 프로젝트의 요구 사항에 맞게 선택할 수 있습니다. **Flask는 간결하고 유연한 구조를 가지며, 작은 프로젝트나 간단한 API 개발에 적합**합니다. 반면 **FastAPI는 높은 성능과 자동 API 문서 생성 기능을 제공하여 대규모 프로젝트와 비동기 처리를 필요로 하는 경우에 더욱 유용**합니다. 

## FastApi

### 장점

FastAPI는 최신 Python 기반 프레임워크로 빠른 성능과 사용하기 쉬운 API로 유명합니다. 비동기 프로그래밍을 지원하므로 실시간 애플리케이션 구축에 적합합니다. 또한 자동 API 문서화 및 유효성 검사를 제공하여 개발자의 시간과 노력을 절약합니다.

### 단점

FastAPI는 비교적 새로운 프레임워크이며 기존 프레임워크에 비해 커뮤니티 지원 및 리소스가 많지 않을 수 있습니다. 또한 비동기 프로그래밍을 처음 접하는 개발자를 위한 학습 곡선도 있습니다.

### 활용도

FastAPI는 특히 데이터 집약적인 애플리케이션을 위한 실시간 및 고성능 API 구축에 적합합니다.

## Flask

### 장점

Flask는 배우고 사용하기 쉬운 경량 Python 기반 프레임워크입니다. 유연성을 제공하고 개발자가 모듈식 및 확장 가능한 방식으로 웹 애플리케이션을 구축할 수 있도록 합니다. 또한 사용자 정의가 가능하고 소규모 프로젝트를 구축하는 데 적합합니다.

### 단점

Flask는 다른 프레임워크에 비해 기본 제공 기능이 적기 때문에 개발자가 구현하는 데 더 많은 노력과 시간이 필요할 수 있습니다. 또한 대규모 웹 애플리케이션을 구축하는 데 적합하지 않을 수도 있습니다.

### 활용

Flask는 개인 웹 사이트, 간단한 API 및 내부 대시보드와 같은 소규모 웹 애플리케이션 및 프로토타입을 구축하는 데 적합합니다.

## **FastAPI 의 장점**

- 의존성 주입(DI) 위주의 설계로, DB 등 의존성 관리가 편리하고 버그 위험이 적다
- 동시성(Concurrency) 기반의 비동기 동작으로 충분히 빠른 성능을 낸다
- Pydantic 기반의 Validation 이 잘 동작한다
- Swagger(OpenAPI) 기반의 자동 문서화가 효율적이다(!)
- Starlette 을 갖다쓴 덕분에 WebSocket 과 같은 빌트인 기능이 충분하다
- 공식 문서가 훌륭하다

*의존성 주입은 

의존성 주입(Dependency Injection)은 객체 지향 설계 원칙 중 하나로, 클래스나 함수가 직접 필요로 하는 의존 객체(dependency)를 생성하는 것이 아니라, 외부에서 주입받도록 설계하는 패턴입니다. 이 패턴을 사용하면 코드의 결합도를 낮출 수 있고, 유지보수와 테스트가 쉬워집니다.

- **유연성과 재사용성**: 의존성 객체를 외부에서 주입받기 때문에, 동일한 클래스가 다양한 의존성을 가질 수 있고 재사용성이 높아집니다.
- **테스트 용이성**: 의존성 객체를 모의(mock) 객체로 대체하여 단위 테스트를 수행하기 쉬워집니다.
- **결합도 감소**: 클래스 간의 강한 결합을 피할 수 있어 유지보수가 용이해집니다.