### 3 계층 네트워크 계층

### routing이란?

패킷이 이동할 최적의 경로를 설정한뒤 해당경로로 패킷을 이동시키는것

Router는 네트워크 계층의 핵심기능을 담당하는 장비

라우터와 L3는 상당히 유사해서 엄밀히 구분하지 않는 경우가 많음

호스트 간의 통신과정은 라우터를 거쳐서 이동하는 과정이 필요하고 이걸 ‘홉’이라고 부름

홉이라는 과정은 라우터가 저장하는 라우팅 테이블을 통해 이루어지고,

라우팅 테이블은 특정 수신지까지 도달하기 위한 정보를 명시한 일종의 표와 같은 정보

여기에는 대표적인 정보로 ‘네트워크 인터페이스’, ‘메트릭’이있음

라우팅 테이블의 내용 

- 수신지 IP주소, 서브넷 마스크
- 다음 홉 == 게이트웨이
- 네트워크 인터페이스 - 패킷을 내보낼 통로
- 메트릭 - 경로로 이동하는 데에 드는 비용을 의미

이 라우팅 테이블은 정적 라우팅, 동적라우팅 두 가지 방법으로 작성될 수 있음

정적 라우팅은 사용자가 내용을 수동으로 입력

동적 라우팅은 자동으로 테이블 항목을 바꿔 항목이 수시로 변할수있음

홉의 과정에서 패킷이 이동할 경로를 최적의 경로로 찾는과정을 ‘라우팅 프로토콜’이라고 부른다. 

( 이 과정은 동적 라우팅에서 이루어짐) 

라우팅 ———-자동————————동적라우팅————as내부 ———IGP(interior gateway protocol)

|________수동___정적라우팅.            |__________as외부 _____EGP(exterior gateway protocol)

# 4계층 전송계층(신뢰할수있는 전송을 위한)

## 4-1 ip의 한계와 포트

네트워크 계층의 ip는 신뢰할 수 없는 ‘비연결형 통신’을 수행함 

네트워크 계층의 ip의 역할은 크게 ip단편화, ip주소지정 두가지가 있는데, 

이것 말고 한계점으로 ‘비신뢰성 프로토콜’ ‘비연결형 프로토콜’임

### 비신뢰성 프로토콜

- 최선형 전달
    - 패킷이 수신지까지 제대로 전송되었다는 보장을 하지않음
    - 손상 및 중복되도 재전송하지않고, 순서대로 도착하는 보장도 하지않음

### 비연결형 프로토콜

- 송수신 호스트간의 연결 수립작업을 거치지않고 패킷을 보내기만함

그렇다면 전송계층은 어떤 역할을??

TCP

1. 전송계층은 연결형 통신을 가능하게함
    1. TCP를 이용해 호스트 간의 가상의 회선을 설정하듯 연결을 수립
2. 신뢰성있는 통신을 가능하게함.
    1. TCP를 이용해 오류제어, 흐름제어, 혼잡제어의 기능을 제공

이와 반대로 빠르고 높은 성능을 위해 비신뢰성, 비연결형 프로토콜이 필요할 때가 있음 이때 UDP를 사용

UDP

신뢰할 수 없는 통신, 비연결형 통신을 가능하게 하고 TCP보다 빠른 전송이 가능

*{책에 없는 내용, 네트워크 계층의 ip프로토콜과 UDP의 차이점은 뭐지?*

- ***계층**:*
    - *IP는 네트워크 계층의 프로토콜로, 주로 패킷 전달과 라우팅을 담당합니다.*
    - *UDP는 전송 계층의 프로토콜로, 애플리케이션 간의 통신을 관리합니다.*
- ***포트 번호**:*
    - *IP는 포트 번호를 사용하지 않고 IP 주소를 기반으로 패킷을 전달합니다.*
    - *UDP는 포트 번호를 사용하여 동일한 IP 주소 내에서 여러 애플리케이션 간의 통신을 가능하게 합니다.*
    
    *}*
    

전송계층이 네트워크계층의 한계점을 극복한걸 알았다면, 다음 계층인 응용계층과는 어떻게 역할을 하는가?

전송계층에서는 포트를 이용해서 응용계층과 연결함

포트 - 패킷이 실행중인 특정 애플리케이션까지 전달되려면 패킷에 특정 애플리케이션을 식별할 수 있는 정보가 포함되어야함. 수신지 포트와 송신지 포트를 통해 호스트의 애플리케이션을 식별함

포트는 총 65536이며 0~1023은 well_known, 1023~49151은 registered port, 나머지는 동적포트이다.

## 4-2 TCP와 UDP

TCP는 신뢰할 수 있는 통신을 위한 연결형 프로토콜

UDP는 TCP보다 신뢰성은 떨어지지만 비교적 빠른 통신이 가능한 비연결형 프로토콜

MSS - Maximum Segment Size의 약자로 TCP로 전송할 수 있는 최대 페이로드 크기를 의미

| 이더넷 헤더 | ip헤더 | TCP헤더  | 페이로드 | FCS |
| --- | --- | --- | --- | --- |
|  |  |  | TCP MSS |  |

                            |_________________________IP MTU ___________|

### TCP 세그먼트는 아래와 같이 이루어짐

송신지 포트, 수신지 포트

순서번호

확인 응답번호

제어비트 

윈도우

제어비트

ACK - 세그먼트 승인을 나타내기 위한 비트

SYN - 연결을 수립하기 위한 비트

FIN - 연결을 종료하기 위한 비트 

### TCP 연결수립과 종료

연결 수립: 쓰리 웨이 핸드셰이크 

| 송수신방향 | 세그먼트 | 비유 |
| --- | --- | --- |
| A → B | SYN 세그먼트 | 연결을 시작합니다. |
| B → A | ACK + SYN 세그먼트 | 확인했습니다. , 연결을 시작합니다. |
| A → B | ACK 세그먼트 | 네 확인했습니다. |

## http와 https의 차이

HTTP(HyperText Transfer Protocol)와 HTTPS(HyperText Transfer Protocol Secure)는 응용계층의 통신 방법이다. http는 데이터를 암호화하지 않은 상태로 전송하는 반면, https는 데이터를 암호화하여 전송

http는 데이터를 평문으로 전송하여 중간에 탈취당하여도 쉽게 읽히는 보안문제가 있다. 

보안이 크게 중요하지 않은 웹사이트나 애플리케이션에서 주로 사용된다. 

https는 암호화전송을 통해 탈취를 당해도 내용을 읽을수 없도록 만들었는데 이 과정에서 사용하는 것이 SSL(Secure Sockets Layer)이다. 프로토콜 송수신자는 SSL이 있어야 암호화된 통신내용을 읽을 수 있고, 중간에 탈취당해도 내용에 대한 보안이 이뤄진다. 

HTTP(HyperText Transfer Protocol)와 HTTPS(HyperText Transfer Protocol Secure)의 주요 차이점은 보안입니다. HTTP는 데이터를 암호화하지 않은 상태로 전송하는 반면, HTTPS는 데이터를 암호화하여 전송합니다. 이 차이는 웹 브라우저와 웹 서버 간의 통신에서 중요한 보안 및 개인정보 보호 기능을 제공합니다.